document.addEventListener("DOMContentLoaded", (e) => {
  const includeHTML = (el, url, callback) => {
    const xhr = new XMLHttpRequest();

    xhr.addEventListener("readystatechange", (e) => {
      if (xhr.readyState !== 4) return;

      if (xhr.status >= 200 && xhr.status < 300) {
        el.outerHTML = xhr.responseText;

        // Kjør callback når innholdet er satt inn i DOM
        if (typeof callback === "function") {
          callback();
        }
      } else {
        let message =
          xhr.statusText ||
          "Error: Could not load the file. Make sure the request is via HTTP or HTTPS.";
        el.outerHTML = `<div><p>${message}</p></div>`;
      }
    });

    xhr.open("GET", url);
    xhr.setRequestHeader("Content-type", "text/html; charset=utf-8");
    xhr.send();
  };

  document.querySelectorAll("[data-include]").forEach((el) => {
    includeHTML(el, el.getAttribute("data-include"), () => {
      console.log("nav.html er lastet!");

      // Kjør scriptet her, siden vi nå vet at nav.html er lastet
      if (typeof arstall !== "undefined") {
        visArstall(arstall);
      } else {
        console.warn("Variabelen 'arstall' er ikke definert.");
      }
    });
  });
});
